<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Ticaret Finansal Sim√ºlat√∂r√º - Nihai</title>
    <style>
        /* Genel Stil ve Temel Ayarlar */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #eef3f6;
            color: #333;
        }
        .container {
            max-width: 1300px;
            height: 100vh;
            margin: auto;
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 15px;
            padding: 15px;
            box-sizing: border-box;
            overflow: hidden;
        }
        .left-column {
            display: flex;
            flex-direction: column;
            gap: 15px;
            overflow-y: auto;
            padding-right: 5px;
            scrollbar-width: thin;
        }
        .right-column {
            display: grid;
            grid-template-rows: auto 1fr;
            gap: 15px;
        }
        .card {
            background-color: #fff;
            padding: 18px;
            border-radius: 12px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
        }
        h2 {
            color: #007bff;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 8px;
            margin-top: 0;
            font-size: 1.3em;
            font-weight: 600;
        }

        /* Input Stilleri */
        .input-group { position: relative; }
        .input-group label {
            display: block;
            font-size: 0.85em;
            margin-top: 10px;
            margin-bottom: 3px;
            font-weight: 500;
            color: #555;
        }
        .input-group input {
            width: calc(100% - 8px);
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 0.9em;
            transition: border-color 0.3s;
        }
        .input-group input:focus {
            border-color: #007bff;
            outline: none;
        }
        .input-unit {
            position: absolute;
            right: 5px;
            top: 60%;
            transform: translateY(-50%);
            color: #999;
            font-size: 0.9em;
            pointer-events: none;
        }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .grid-analysis { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-top: 10px; }
        .analysis-box { font-size: 0.75em; text-align: center; padding: 4px 0; border-radius: 4px; border: 1px solid #f0f0f0; background-color: #fafafa; }
        .analysis-box p { margin: 0; font-weight: 600; }
        .analysis-box span { display: block; font-size: 0.95em; color: #007bff; }


        /* Output Tablo Stilleri */
        .output-table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 0.88em; }
        .output-table th, .output-table td { padding: 7px 10px; text-align: left; border-bottom: 1px solid #f0f0f0; }
        .output-table th { background-color: #f8f9fa; font-weight: 500; }
        .subtotal-row th, .subtotal-row td { font-weight: bold; background-color: #e9ecef; }
        .final-row th, .final-row td { font-weight: bold; font-size: 1em; background-color: #d1e7dd; }
        .kdv-row th, .kdv-row td { background-color: #fff3cd; color: #856404; font-weight: bold; }

        /* Deƒüer Stilleri */
        .negative-value { color: #dc3545; font-weight: 600; }
        .positive-value { color: #28a745; font-weight: 600; }
        .highlight-net { font-size: 1.1em; font-weight: bold; }

        /* KPI ve Analiz B√∂l√ºmleri */
        .right-grid-bottom {
            display: grid;
            grid-template-columns: 1.3fr 1fr;
            gap: 15px;
        }
        .kpi-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .kpi-box {
            background-color: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e0e0e0;
        }
        .kpi-box h4 { margin: 0; color: #495057; font-size: 0.9em; }
        .kpi-box p { font-size: 1.5em; font-weight: bold; margin: 5px 0 0 0; color: #007bff; }
    </style>
</head>
<body>

<div class="container">
    <div class="left-column">
        <div class="card">
            <h2>üí∞ Satƒ±≈ü ve Birim Verileri</h2>
            <p style="font-size: 0.8em; color: #6c757d;">*Parasal Girdiler KDV Dahil. Gider KDV'si: %20.</p>
            <div class="grid-2">
                <div class="input-group">
                    <label for="adet">Tahmini Satƒ±≈ü Adedi (Aylƒ±k)</label>
                    <input type="number" id="adet" value="500" oninput="calculate()">
                </div>
                <div class="input-group">
                    <label for="satisFiyat">Birim Satƒ±≈ü Fiyatƒ± (KDV Dahil, ‚Ç∫)</label>
                    <input type="number" id="satisFiyat" value="999.99" oninput="calculate()">
                    <span class="input-unit">‚Ç∫</span>
                </div>
            </div>
            <div class="grid-2">
                <div class="input-group">
                    <label for="birimMaliyet">Birim Maliyet (KDV Dahil, ‚Ç∫)</label>
                    <input type="number" id="birimMaliyet" value="312.98" oninput="calculate()">
                    <span class="input-unit">‚Ç∫</span>
                </div>
                <div class="input-group">
                    <label for="kargo">Ort. Kargo Gideri (KDV Dahil, ‚Ç∫)</label>
                    <input type="number" id="kargo" value="85.44" oninput="calculate()">
                    <span class="input-unit">‚Ç∫</span>
                </div>
            </div>
            <div class="grid-3">
                <div class="input-group">
                    <label for="komisyon">Komisyon Y√ºzdesi (%)</label>
                    <input type="number" id="komisyon" value="21" oninput="calculate()">
                    <span class="input-unit">%</span>
                </div>
                <div class="input-group">
                    <label for="kdvOrani">Satƒ±≈ü/Alƒ±≈ü KDV Oranƒ± (%)</label>
                    <input type="number" id="kdvOrani" value="20" oninput="calculate()">
                    <span class="input-unit">%</span>
                </div>
                <div class="input-group">
                    <label for="iadeOrani">ƒ∞ade Oranƒ± (%)</label>
                    <input type="number" id="iadeOrani" value="8" oninput="calculate()">
                    <span class="input-unit">%</span>
                </div>
            </div>
            <div class="input-group">
                <label for="gelirVergisi">Gelir/Kurumlar Vergisi Oranƒ± (%)</label>
                <input type="number" id="gelirVergisi" value="25" oninput="calculate()">
                <span class="input-unit">%</span>
            </div>
        </div>

        <div class="card">
            <h2>üîß Sabit Giderler (Aylƒ±k - KDV Dahil)</h2>
            <p style="font-size: 0.8em; color: #6c757d;">(KDV %20 Oranƒ±ndan D√º≈ü√ºlecektir)</p>
            <div class="grid-2">
                <div class="input-group">
                    <label for="personel">Personel (‚Ç∫)</label>
                    <input type="number" id="personel" value="17082" oninput="calculate()">
                    <span class="input-unit">‚Ç∫</span>
                </div>
                <div class="input-group">
                    <label for="depo">Depo / Kira (‚Ç∫)</label>
                    <input type="number" id="depo" value="5000" oninput="calculate()">
                    <span class="input-unit">‚Ç∫</span>
                </div>
            </div>
            <div class="grid-2">
                <div class="input-group">
                    <label for="muhasebe">Muhasebe / Yazƒ±lƒ±m (‚Ç∫)</label>
                    <input type="number" id="muhasebe" value="4800" oninput="calculate()">
                    <span class="input-unit">‚Ç∫</span>
                </div>
                <div class="input-group">
                    <label for="pazarlama">Pazarlama / Reklam (‚Ç∫)</label>
                    <input type="number" id="pazarlama" value="10000" oninput="calculate()">
                    <span class="input-unit">‚Ç∫</span>
                </div>
            </div>
            <div class="input-group">
                <label for="digerGiderler">Diƒüer Giderler (‚Ç∫)</label>
                <input type="number" id="digerGiderler" value="2000" oninput="calculate()">
                <span class="input-unit">‚Ç∫</span>
            </div>
        </div>

        <div class="card">
            <h2>üéØ Hedefler</h2>
            <div class="input-group">
                <label for="hedefKarTL">Hedef Net K√¢r (‚Ç∫)</label>
                <input type="number" id="hedefKarTL" value="50000" oninput="calculate()">
                <span class="input-unit">‚Ç∫</span>
            </div>
        </div>
    </div>

    <div class="right-column">
        <div class="card" style="grid-row: 1;">
            <h2>üìà Aylƒ±k K√¢r/Zarar Tablosu <span style="font-size: 0.8em; float: right; color: #6c757d;">(‚Ç∫, KDV Hari√ß Net Tutarlar)</span></h2>
             <div id="output-kar-marji-yuzde" class="grid-analysis">
                </div>
            <table class="output-table">
                <tr><th>Br√ºt Satƒ±≈ü Hasƒ±latƒ±</th><td id="output-brutSatisHasilati"></td></tr>
                <tr><th>(-) ƒ∞ade Tutarƒ±</th><td id="output-iadeTutari"></td></tr>
                <tr class="subtotal-row"><th>= Net Satƒ±≈ü Hasƒ±latƒ±</th><td id="output-netSatisHasilati"></td></tr>
                <tr><th>(-) Satƒ±lan Malƒ±n Maliyeti (SM)</th><td id="output-sm"></td></tr>
                <tr class="subtotal-row"><th>= Br√ºt K√¢r</th><td id="output-brutKar"></td></tr>
                
                <tr><th colspan="2" style="background-color: #f1f1f1; text-align: center;">Faaliyet Giderleri Detayƒ± (KDV Hari√ß)</th></tr>
                <tr><th>(-) Pazaryeri Komisyonu (Deƒüi≈üken)</th><td id="output-komisyonGideri"></td></tr>
                <tr><th>(-) Kargo Gideri (Deƒüi≈üken)</th><td id="output-kargoGideri"></td></tr>
                <tr><th>(-) Platform Hizmet Bedeli (Deƒüi≈üken)</th><td id="output-platformGideri"></td></tr>
                <tr><th>(-) Stopaj Gideri (Deƒüi≈üken)</th><td id="output-stopajGideri"></td></tr>
                <tr><th>(-) Toplam Sabit Giderler</th><td id="output-sabitGiderlerToplam"></td></tr>
                
                <tr class="subtotal-row"><th>(-) Toplam Faaliyet Giderleri</th><td id="output-faaliyetGiderleri"></td></tr>
                
                <tr class="subtotal-row"><th>= Faaliyet K√¢rƒ± (EBIT)</th><td id="output-faaliyetKar"></td></tr>
                <tr><th>(-) Gelir/Kurumlar Vergisi</th><td id="output-vergi"></td></tr>
                <tr class="final-row"><th class="highlight-net">NET K√ÇR / ZARAR</th><td id="output-netKar" class="highlight-net"></td></tr>
            </table>
        </div>

        <div class="right-grid-bottom" style="grid-row: 2;">
            <div class="card" style="padding: 0; box-shadow: none;">
                <h2>‚öñÔ∏è Vergi Analizi (Detaylƒ±)</h2>
                <table class="output-table">
                    <tr><th>Satƒ±≈ü KDV'si (Hesaplanan)</th><td id="output-satisKDV"></td></tr>
                    <tr class="subtotal-row"><th colspan="2" style="text-align: center;">ƒ∞ndirilebilir KDV Detayƒ±</th></tr>
                    <tr><th>(+) Alƒ±≈ü KDV (SM)</th><td id="output-alisKDV"></td></tr>
                    <tr><th>(+) Komisyon KDV</th><td id="output-komisyonKDV"></td></tr>
                    <tr><th>(+) Kargo KDV</th><td id="output-kargoKDV"></td></tr>
                    <tr><th>(+) Platform Hiz. KDV</th><td id="output-platformKDV"></td></tr>
                    <tr><th>(+) Sabit Giderler KDV</th><td id="output-sabitKDV"></td></tr>
                    
                    <tr class="subtotal-row"><th>Toplam ƒ∞ndirilebilir KDV</th><td id="output-indirilebilirKDV"></td></tr>
                    <tr class="final-row"><th class="highlight-vat">√ñdenecek KDV Tutarƒ±</th><td id="output-odenecekKDV" class="highlight-vat"></td></tr>
                    <tr class="kdv-row"><th class="highlight-vat">Biriken (Devreden) KDV</th><td id="output-devredenKDV" class="highlight-vat"></td></tr>
                </table>
            </div>

            <div>
                <div class="kpi-group">
                    <div class="kpi-box">
                        <h4>Ba≈üaba≈ü Noktasƒ± (Adet)</h4>
                        <p id="output-bepAdet"></p>
                    </div>
                    <div class="kpi-box">
                        <h4>Hedef K√¢r ƒ∞√ßin Gerekli Adet (‚Ç∫ Hedefi)</h4>
                        <p id="output-hedefAdet"></p>
                    </div>
                </div>
                
                <h2 style="margin-top: 15px;">üìà Birim Ekonomisi</h2>
                <table class="output-table">
                    <tr><th>Birim Satƒ±≈ü Fiyatƒ± (KDV Hari√ß)</th><td id="output-birimSatisNet"></td></tr>
                    <tr class="subtotal-row"><th>Hedef K√¢r ƒ∞√ßin Birim Fiyat (KDV Dahil)</th><td id="output-hedefFiyatKDVIncl"></td></tr>
                    <tr><th>Birim Maliyetler Toplamƒ± (KDV Hari√ß)</th><td id="output-birimToplamMaliyet"></td></tr>
                    <tr class="subtotal-row"><th>Birim Katkƒ± Payƒ±</th><td id="output-katkiPayiBirim"></td></tr>
                    <tr class="final-row"><th>Net K√¢r / Birim</th><td id="output-netKarBirim"></td></tr>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    // Zorunlu Sabitler
    const PLATFORM_FEE_KDV_INCL = 10.19;
    const GIDER_KDV_ORANI_SABIT = 20; 
    const STOPAJ_RATE = 0.01; // %1 Stopaj oranƒ±

    // --- G√úVENLƒ∞K VE FORMATLAMA FONKSƒ∞YONLARI ---
    const getNum = (id) => {
        const value = document.getElementById(id).value;
        const num = parseFloat(value.replace(',', '.')) || 0;
        return num;
    };

    const formatTL = (number) => {
        const formatted = Math.abs(number).toFixed(2).replace('.', ',');
        if (number < 0) {
            return `<span class="negative-value">(‚Ç∫${formatted})</span>`;
        } else {
            return `<span class="positive-value">‚Ç∫${formatted}</span>`;
        }
    };

    const formatPercent = (number) => {
        return (number * 100).toFixed(2).replace('.', ',') + '%';
    };

    const formatKDVIncl = (netAmount, vatRate) => {
        const rateDecimal = vatRate / 100;
        const total = netAmount * (1 + rateDecimal);
        return total; 
    };

    const solveVAT = (amountKDVIncl, vatRate) => {
        const rateDecimal = vatRate / 100;
        if (vatRate === 0 || amountKDVIncl === 0) {
            return { net: amountKDVIncl, vat: 0 };
        }
        const net = amountKDVIncl / (1 + rateDecimal);
        const vat = amountKDVIncl - net;
        return { net, vat };
    };

    // --- ANA HESAPLAMA FONKSƒ∞YONU ---
    const calculate = () => {
        // --- 1. Girdileri Al ---
        const adet = getNum('adet');
        const satisFiyatKDV = getNum('satisFiyat');
        const birimMaliyetKDV = getNum('birimMaliyet');
        const kargoKDV = getNum('kargo');
        const komisyonYuzde = getNum('komisyon') / 100;
        const genelKdvOrani = getNum('kdvOrani'); 
        const iadeOrani = getNum('iadeOrani') / 100;
        const gelirVergisiYuzde = getNum('gelirVergisi') / 100;

        const personelKDV = getNum('personel');
        const depoKDV = getNum('depo');
        const muhasebeKDV = getNum('muhasebe');
        const pazarlamaKDV = getNum('pazarlama');
        const digerGiderlerKDV = getNum('digerGiderler');
        
        const hedefKarTL = getNum('hedefKarTL');

        // Satƒ±≈ü Adedi 0 ise hesaplamayƒ± durdur.
        if (adet === 0) {
             const zeroTL = formatTL(0);
             const zeroP = '0.00%';
             // T√ºm outputlarƒ± sƒ±fƒ±rla
            document.getElementById('output-netKar').innerHTML = zeroTL;
            document.getElementById('output-bepAdet').innerHTML = `Girdi Gerekli`;
            document.getElementById('output-hedefFiyatKDVIncl').innerHTML = zeroTL;
            document.getElementById('output-netKarBirim').innerHTML = zeroTL;
            document.getElementById('output-katkiPayiBirim').innerHTML = zeroTL;
            document.getElementById('output-faaliyetKar').innerHTML = zeroTL;
            document.getElementById('output-odenecekKDV').innerHTML = zeroTL;
            document.getElementById('output-devredenKDV').innerHTML = zeroTL;
            document.getElementById('output-brutSatisHasilati').innerHTML = zeroTL;
            document.getElementById('output-iadeTutari').innerHTML = zeroTL;
            document.getElementById('output-netSatisHasilati').innerHTML = zeroTL;
            document.getElementById('output-sm').innerHTML = zeroTL;
            document.getElementById('output-brutKar').innerHTML = zeroTL;
            document.getElementById('output-faaliyetGiderleri').innerHTML = zeroTL;

            // Y√ºzdesel ifadeleri sƒ±fƒ±rla
            document.getElementById('output-kar-marji-yuzde').innerHTML = `
                <div class="analysis-box">K√¢r Marjƒ± (Br√ºt)<span>${zeroP}</span></div>
                <div class="analysis-box">K√¢r Marjƒ± (Faaliyet)<span>${zeroP}</span></div>
                <div class="analysis-box">K√¢r Marjƒ± (Net)<span>${zeroP}</span></div>
                <div class="analysis-box">ƒ∞ade Oranƒ± (Tutar)<span>${zeroP}</span></div>
            `;
            return;
        }

        // --- 2. KDV √á√∂z√ºmleme ---
        const satis = solveVAT(satisFiyatKDV, genelKdvOrani);
        const maliyet = solveVAT(birimMaliyetKDV, genelKdvOrani);
        const kargo = solveVAT(kargoKDV, GIDER_KDV_ORANI_SABIT);
        const platformFee = solveVAT(PLATFORM_FEE_KDV_INCL, GIDER_KDV_ORANI_SABIT);
        
        const personelNet = personelKDV; 
        const depo = solveVAT(depoKDV, GIDER_KDV_ORANI_SABIT);
        const muhasebe = solveVAT(muhasebeKDV, GIDER_KDV_ORANI_SABIT);
        const pazarlama = solveVAT(pazarlamaKDV, GIDER_KDV_ORANI_SABIT);
        const digerGiderler = solveVAT(digerGiderlerKDV, GIDER_KDV_ORANI_SABIT);

        // --- 3. Gelir ve Br√ºt K√¢r Hesaplamasƒ± (KDV Hari√ß) ---
        const brutSatisHasilatiKDVHari√ß = satis.net * adet;
        const iadeKaybiAdet = adet * iadeOrani;
        const iadeTutariNet = iadeKaybiAdet * satis.net;
        
        const netSatisHasilati = brutSatisHasilatiKDVHari√ß - iadeTutariNet; 
        const smToplam = maliyet.net * adet;
        const brutKar = netSatisHasilati - smToplam; 

        // --- 4. Faaliyet Giderleri (KDV Hari√ß) ---
        const komisyonToplam = netSatisHasilati * komisyonYuzde;
        const kargoToplam = kargo.net * adet;
        const platformFeeToplam = platformFee.net * adet;
        const stopajBirim = satis.net * STOPAJ_RATE;
        const stopajToplam = stopajBirim * adet;

        const sabitGiderlerToplamNet = personelNet + depo.net + muhasebe.net + pazarlama.net + digerGiderler.net;
        
        const faaliyetGiderleriToplam = komisyonToplam + kargoToplam + platformFeeToplam + stopajToplam + sabitGiderlerToplamNet;

        // --- 5. Faaliyet ve Net K√¢r ---
        const faaliyetKar = brutKar - faaliyetGiderleriToplam; 
        const vergi = faaliyetKar > 0 ? faaliyetKar * gelirVergisiYuzde : 0;
        const netKar = faaliyetKar - vergi; 

        // --- 6. √ñdenecek KDV Hesaplamasƒ± ---
        const satisKDVTutari = satis.vat * (adet - iadeKaybiAdet);
        
        const alisKDV = maliyet.vat * adet; 
        const kargoKDVTutari = kargo.vat * adet;
        const platformFeeKDV = platformFee.vat * adet;
        const komisyonKDV = komisyonToplam * (GIDER_KDV_ORANI_SABIT / 100); 
        const sabitGiderlerKDVToplam = depo.vat + muhasebe.vat + pazarlama.vat + digerGiderler.vat;

        const indirilebilirKDVToplam = alisKDV + komisyonKDV + kargoKDVTutari + platformFeeKDV + sabitGiderlerKDVToplam;

        const odenecekKDVBrut = satisKDVTutari - indirilebilirKDVToplam;
        
        const odenecekKDV = odenecekKDVBrut > 0 ? odenecekKDVBrut : 0;
        const devredenKDV = odenecekKDVBrut < 0 ? Math.abs(odenecekKDVBrut) : 0;

        // --- 7. Birim Ekonomisi ve BEP/Hedef ---
        const birimToplamMaliyet = faaliyetGiderleriToplam / adet + smToplam / adet;
        
        const birimKomisyon = komisyonToplam / adet;
        const birimDeƒüi≈ükenMaliyetlerTop = maliyet.net + birimKomisyon + kargo.net + platformFee.net + stopajBirim;
        
        const katkiPayiBirim = satis.net - birimDeƒüi≈ükenMaliyetlerTop;

        const bepAdet = katkiPayiBirim > 0 ? sabitGiderlerToplamNet / katkiPayiBirim : 0;
        const hedefAdet = katkiPayiBirim > 0 ? (sabitGiderlerToplamNet + hedefKarTL) / katkiPayiBirim : 0;

        // HEDEF K√ÇR ƒ∞√áƒ∞N GEREKLƒ∞ SATI≈û Fƒ∞YATI (KRƒ∞Tƒ∞K HESAPLAMA)
        const hedefKarNet = hedefKarTL / (1 - gelirVergisiYuzde); 

        const birimSabitGider = sabitGiderlerToplamNet / adet;
        const birimHedefKarNet = hedefKarNet / adet;

        const birimDeƒüi≈ükenMaliyetlerHari√ßKomisyon = maliyet.net + kargo.net + platformFee.net + stopajBirim;
        
        const pay = birimDeƒüi≈ükenMaliyetlerHari√ßKomisyon + birimSabitGider + birimHedefKarNet;
        const payda = (1 - komisyonYuzde) * (1 - iadeOrani);
        
        let hedefBirimSatisNet = 0;
        if (payda > 0) {
             hedefBirimSatisNet = pay / payda;
        }

        const hedefFiyatKDVIncl = formatKDVIncl(hedefBirimSatisNet, genelKdvOrani);

        // --- 8. √áƒ±ktƒ±larƒ± DOM'a Yazma ---
        document.getElementById('output-brutSatisHasilati').innerHTML = formatTL(brutSatisHasilatiKDVHari√ß);
        document.getElementById('output-iadeTutari').innerHTML = formatTL(iadeTutariNet);
        document.getElementById('output-netSatisHasilati').innerHTML = formatTL(netSatisHasilati);
        document.getElementById('output-sm').innerHTML = formatTL(smToplam);
        document.getElementById('output-brutKar').innerHTML = formatTL(brutKar);
        
        // Faaliyet Giderleri Detay
        document.getElementById('output-komisyonGideri').innerHTML = formatTL(komisyonToplam);
        document.getElementById('output-kargoGideri').innerHTML = formatTL(kargoToplam);
        document.getElementById('output-platformGideri').innerHTML = formatTL(platformFeeToplam);
        document.getElementById('output-stopajGideri').innerHTML = formatTL(stopajToplam);
        document.getElementById('output-sabitGiderlerToplam').innerHTML = formatTL(sabitGiderlerToplamNet);

        document.getElementById('output-faaliyetGiderleri').innerHTML = formatTL(faaliyetGiderleriToplam);
        document.getElementById('output-faaliyetKar').innerHTML = formatTL(faaliyetKar);
        document.getElementById('output-vergi').innerHTML = formatTL(vergi);
        document.getElementById('output-netKar').innerHTML = formatTL(netKar);

        // Y√ºzdesel ƒ∞fadeler ve K√¢r Marjlarƒ±
        const marginBrut = netSatisHasilati !== 0 ? brutKar / netSatisHasilati : 0;
        const marginFaaliyet = netSatisHasilati !== 0 ? faaliyetKar / netSatisHasilati : 0;
        const marginNet = netSatisHasilati !== 0 ? netKar / netSatisHasilati : 0;
        const marginIade = brutSatisHasilatiKDVHari√ß !== 0 ? iadeTutariNet / brutSatisHasilatiKDVHari√ß : 0;

        document.getElementById('output-kar-marji-yuzde').innerHTML = `
            <div class="analysis-box">K√¢r Marjƒ± (Br√ºt)<span>${formatPercent(marginBrut)}</span></div>
            <div class="analysis-box">K√¢r Marjƒ± (Faaliyet)<span>${formatPercent(marginFaaliyet)}</span></div>
            <div class="analysis-box">K√¢r Marjƒ± (Net)<span>${formatPercent(marginNet)}</span></div>
            <div class="analysis-box">ƒ∞ade Oranƒ± (Tutar)<span>${formatPercent(marginIade)}</span></div>
        `;


        // Vergi Analizi Detay
        document.getElementById('output-satisKDV').innerHTML = formatTL(satisKDVTutari);
        document.getElementById('output-alisKDV').innerHTML = formatTL(alisKDV);
        document.getElementById('output-komisyonKDV').innerHTML = formatTL(komisyonKDV);
        document.getElementById('output-kargoKDV').innerHTML = formatTL(kargoKDVTutari);
        document.getElementById('output-platformKDV').innerHTML = formatTL(platformFeeKDV);
        document.getElementById('output-sabitKDV').innerHTML = formatTL(sabitGiderlerKDVToplam);
        document.getElementById('output-indirilebilirKDV').innerHTML = formatTL(indirilebilirKDVToplam);
        document.getElementById('output-odenecekKDV').innerHTML = formatTL(odenecekKDV);
        document.getElementById('output-devredenKDV').innerHTML = formatTL(devredenKDV);

        // Birim/Hedef Analizi
        document.getElementById('output-birimSatisNet').innerHTML = formatTL(satis.net);
        document.getElementById('output-birimToplamMaliyet').innerHTML = formatTL(birimToplamMaliyet);
        document.getElementById('output-katkiPayiBirim').innerHTML = formatTL(katkiPayiBirim);
        document.getElementById('output-netKarBirim').innerHTML = formatTL(netKar / adet);

        document.getElementById('output-bepAdet').innerHTML = `${Math.ceil(bepAdet)} Adet`;
        document.getElementById('output-hedefAdet').innerHTML = `${Math.ceil(hedefAdet)} Adet`;
        document.getElementById('output-hedefFiyatKDVIncl').innerHTML = hedefBirimSatisNet > 0 ? `‚Ç∫${hedefFiyatKDVIncl.toFixed(2).replace('.', ',')}` : `‚Ç∫0,00 (Hata)`;
    };

    document.addEventListener('DOMContentLoaded', calculate);
</script>
</body>
</html>